<!DOCTYPE html>
<html>
   <head>
		<meta name = "viewport" content = "width = device-width, initial-scale = 1">
		<link rel = "stylesheet" href = "https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
		<script src = "https://code.jquery.com/jquery-1.11.3.min.js"></script>
		<script src = "https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
		<style>
			h3{
				text-align:center;
			}
			<!-- .ui-body-a, -->
			<!-- .ui-page-theme-a.ui-body-inherit, -->
			<!-- html.ui-bar-a.ui-body-inherit, -->
			<!-- html.ui-body-a.ui-body-inherit, -->
			<!-- html body.ui-group-theme-a.ui-body-inherit, -->
			<!-- html.ui-panel-page-container-a{ -->
				<!-- color:green; -->
			<!-- } -->
			li{
				<!-- text-align:center !important; -->
			}
			
			h4{
				text-align:center;
			}
			
			li.wrong{
				background: #ff416c; /* fallback for old browsers */
				background: -webkit-linear-gradient(to top, #ff416c, #ff4b2b); /* Chrome 10-25, Safari 5.1-6 */
				background: linear-gradient(to top, #ff416c, #ff4b2b);
				color:white !important;
			}
			
			li.right{
				background: #11998e;  /* fallback for old browsers */
				background: -webkit-linear-gradient(to top, #38ef7d, #11998e);  /* Chrome 10-25, Safari 5.1-6 */
				background: linear-gradient(to top, #38ef7d, #11998e); /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
				color: white !important;
			}
		</style>
	</head>
	<body>
		<div data-role = "page" id = "index">
			<div data-role = "header">
				<h1>Welcome to the history quiz!</h1>
			</div>
			<div data-role = "main" class = "ui-content">
				<form>

				<fieldset data-role = "controlgroup">
					<input type = "radio" id = "radio1" name = "radio-choice-0" />
					<label for = "radio1">Easy</label>

					<input type = "radio" id = "radio2" name = "radio-choice-0" />
					<label for = "radio2">Medium</label>

					<input type = "radio" id = "radio3" name = "radio-choice-0" />
					<label for = "radio3">Hard</label>
				</fieldset>
				
					<label for = "slider">Amount of questions</label>
					<input type = "range" name = "slider" id = "slider" value = "20" min = "1" max = "50" data-highlight = "true">
							
				</form>
				<a class="ui-btn ui-shadow ui-corner-all" id="start" data-transition = "pop">Start!</a>
			</div>
			<div data-role = "footer" class = "ui-content">
				
			</div>
		</div>
		
		<script>
		
		function shuffle(arr) {
			var i,
				j,
				temp;
			for (i = arr.length - 1; i > 0; i--) {
				j = Math.floor(Math.random() * (i + 1));
				temp = arr[i];
				arr[i] = arr[j];
				arr[j] = temp;
			}
			return arr;    
		};

		
		function Question (question, wrongAnswers, rightAnswer) {
			this.question = question;
			this.wrongAnswers = wrongAnswers;
			this.rightAnswer = rightAnswer;
			this.answers = [];
			this.answers.push(this.wrongAnswers[0], this.wrongAnswers[1], this.wrongAnswers[2])
			this.answers.push(this.rightAnswer)
			<!-- alert(this.answers) -->
			shuffle(this.answers)
			<!-- alert(this.answers) -->
			
			this.getQuestion = function() {
				return this.question;
			}
			this.getCorrectAnswer = function() {
				return this.rightAnswer;
			}
			
			this.getTheAnswers = function(){
				return this.answers;
			}
		}
		
			var answerArray = [];
			var questionObjectArray = [];
		
			$(document).ready(function() {
			
			
			
				$("#start").click(function() {
					var slider = parseInt($("#slider").val())
					var pageContent = "";
					
					if(!selectedDifficultyCheck()){
						alert("You have not selected difficulty");
						return;
					}
					
					fetch('https://opentdb.com/api.php?amount='+slider+'&category=23&difficulty='+getDifficulty()+'&type=multiple').then(response => {
						return response.json();
					}).then(data => {
					console.log(data)
						for(var i=0; i <= slider -1; i++){
							questionObjectArray[i] = 
							new Question(
								data.results[i].question,
								data.results[i].incorrect_answers,
								data.results[i].correct_answer
							);
							
							<!-- alert(questionObjectArray[i].getQuestion()) -->
							$("h4#question"+(i+1)+"").html(questionObjectArray[i].getQuestion())
							$("label[for='q"+(i+1)+"answer1']").html(questionObjectArray[i].getTheAnswers()[0]);
							$("label[for='q"+(i+1)+"answer2']").html(questionObjectArray[i].getTheAnswers()[1]);
							$("label[for='q"+(i+1)+"answer3']").html(questionObjectArray[i].getTheAnswers()[2]);
							$("label[for='q"+(i+1)+"answer4']").html(questionObjectArray[i].getTheAnswers()[3]);
						}
						
						
						
					}).catch(err => {
						alert("Error getting API data.")
					});
			
					for(var i = 1; i <= slider; i++){

							pageContent += 
							'<div data-role = "page" id = "page'+i+'">' +
								'<div data-role = "header"><h1>Question #'+i+'</h1> </div>' +
								'<div role = "main" class = "ui-content">'+ 
								
									'<h4 id="question'+i+'">  </h4>' +
								
									'<form>' +
								
									'<fieldset data-role = "controlgroup">'+
										'<input type = "radio" id = "q'+i+'answer1" name = "radio-choice-0" />' +
										'<label for = "q'+i+'answer1">Answer1</label>' +
										
										'<input type = "radio" id = "q'+i+'answer2" name = "radio-choice-0" />' +
										'<label for = "q'+i+'answer2">Answer2</label>' +
										
										'<input type = "radio" id = "q'+i+'answer3" name = "radio-choice-0" />' +
										'<label for = "q'+i+'answer3">Answer3</label>' +
										
										'<input type = "radio" id = "q'+i+'answer4" name = "radio-choice-0" />' +
										'<label for = "q'+i+'answer4">Answer4</label>' +
									'</fieldset>'+
									
									'</form>' +
									
									'<fieldset class = "ui-grid-a">'+
										'<div class = "ui-block-a">'+
											'<a class = "ui-btn ui-corner-all ui-shadow ui-btn-a" onClick="previousQuestionPage('+i+')">Previous Question</a>'+
										'</div>'+
         
										
										'<div class = "ui-block-b">'
										if(i == slider)
											pageContent += '<a class = "ui-btn ui-corner-all ui-shadow ui-btn-b"  id="continueButton'+i+'" onClick="nextQuestionPage('+i+','+slider+')">Get results</a>';
										else
											pageContent += '<a class = "ui-btn ui-corner-all ui-shadow ui-btn-b" id="continueButton'+i+'" onClick="nextQuestionPage('+i+','+slider+')">Next Question</a>';;
										pageContent +=	'</div>' +
									'</fieldset>'
								pageContent +='</div>'+
							'<div data-role = "footer"> <h4>'+i+'/'+slider+'</h4></div>'+
							'</div>';
							
						$("body").html(pageContent);
					}
					$.mobile.navigate("#page1");
					
				});
				
				function getDifficulty(){
					if ($("#radio1").is(":checked")) return "easy";
					else if($("#radio2").is(":checked"))return "medium";
					else if($("#radio3").is(":checked"))return "hard";
				}
				
				function selectedDifficultyCheck(){
					if((typeof getDifficulty()) == "string"){
						return true;
					}
					else if((typeof getDifficulty()) != "string")
					{
						return false;
					}
				}
				
			});
			
			
			function getAnswersFromQuestion(currentNumber){
				if ($("#q"+currentNumber+"answer1").is(":checked")) return $("label[for='q"+(currentNumber)+"answer1']").html();
				else if($("#q"+currentNumber+"answer2").is(":checked"))return $("label[for='q"+(currentNumber)+"answer2']").html();
				else if($("#q"+currentNumber+"answer3").is(":checked"))return $("label[for='q"+(currentNumber)+"answer3']").html();
				else if($("#q"+currentNumber+"answer4").is(":checked"))return $("label[for='q"+(currentNumber)+"answer4']").html();
			}
				
			function allAnswersChecked(amountOfQuestions){
				for(var i = 1; i <= amountOfQuestions; i++){
					if(typeof(getAnswersFromQuestion(i)) != "string") answerArray.push("Not Answered");
					else{ 
					<!-- alert($("label[for='q"+(i)+"answer1']").html()) -->
					<!-- alert(answerArray.push(getAnswersFromQuestion(i).toString())) -->
					answerArray.push(getAnswersFromQuestion(i).toString());}
				}
			}
			
			function nextQuestionPage(currentNumber,lastNumber){
				if(currentNumber == lastNumber){	
					allAnswersChecked(lastNumber)
					generateRightAnswerPage(lastNumber)
				}
				else{
					$.mobile.navigate("#page" + (currentNumber + 1).toString());
				}	
			}
			
			function previousQuestionPage(currentNumber){
				if(currentNumber == 1){
					return
				}
				else $.mobile.navigate("#page" + (currentNumber - 1).toString());
			}
			
			function generateRightAnswerPage(amountOfQuestions){
				var answerPageContent = "";
				
				
				alert(answerArray[0]);
				<!-- alert(questionObjectArray[0].getQuestion()) -->
				
				answerPageContent += 
					'<div data-role = "page" id = "answerPage">'+
						'<div data-role = "header"> <h1>Results / Answers</h1> </div>' +
						'<div role = "main" class = "ui-content">'+
						
						'<h3>Your score : 2/4</h3>'+
						'<br />'
						
						for(var question = 1; question <= amountOfQuestions; question++){
							answerPageContent +=
							'<div data-role = "collapsible">' +
								'<h2>Question '+question+':'+questionObjectArray[question-1].getQuestion()+'</h2>' +
								'<ul data-role="listview">'+
									'<li class="wrong" ui-icon-home ui-btn-icon-left">'+questionObjectArray[question-1].getTheAnswers()[0]+'</li>' +
									'<li class="">'+questionObjectArray[question-1].getTheAnswers()[1]+'</li>' +
									'<li class="">'+questionObjectArray[question-1].getTheAnswers()[2]+'</li>' +
									'<li class="right">'+questionObjectArray[question-1].getTheAnswers()[3]+'</li>' +
								'</ul>'+
							'</div>' 
						}
						<!-- '<h3>Your answers</h3> <br />'+ -->
						
						answerPageContent += '</div>'+
						'<div data-role = "footer"> <h1>Your score: 50%</h1> </div>'+
					'</div>';
				$("body").html(answerPageContent);
				$.mobile.navigate("#answerPage");
			}
			
			
			
		</script>
	</body>
</html>